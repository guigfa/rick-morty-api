import { Component, OnInit } from '@angular/core';
import { FormControl, FormGroup, Validators } from '@angular/forms';
import { Router } from '@angular/router';
import { AuthService } from 'src/shared/guard/auth-guard.service';

@Component({
  selector: 'app-login-page',
  templateUrl: './login-page.component.html',
  styleUrls: ['./login-page.component.scss'],
})
export class LoginPageComponent implements OnInit {
  loginImages = [
    {value: 'https://pm1.aminoapps.com/6456/cd8293b5b5ca243f492aacfc811658aabdfa50ab_00.jpg', selected: false},
    {value:'https://static.wikia.nocookie.net/rickandmorty/images/4/4c/Screen_Shot_2017-12-29_at_4.48.33_PM.png/', selected: false}, 
    {value:'https://static.tvtropes.org/pmwiki/pub/images/abcb6534_7913_4eb1_a7a5_62b081ebc628.png', selected: false},
    {value:'data:image/jpeg;base64,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', selected: false},
    {value: 'https://images.squarespace-cdn.com/content/v1/528252b7e4b00150d03a4848/1503802785970-D7NOQ9UQNLYAY1F6MJAP/RickAndMorty_ScaredMorty1500.png, selected: false'}
  ]

  form: FormGroup = new FormGroup({
    name: new FormControl('', [Validators.required]),
    image: new FormControl('', [Validators.required]),
  });

  constructor(private authService: AuthService, private router: Router) {}

  ngOnInit(): void {
    this.form.valueChanges.subscribe((v) =>
      sessionStorage.setItem('user', JSON.stringify(this.form.value))
    );
  }

  onImageClick(index: number) {
    this.loginImages.forEach((image, i) => {
      if (i !== index) {
        image.selected = false;
      }
    });

    this.loginImages[index].selected = !this.loginImages[index].selected;
    console.log(this.loginImages)
  }

  handleImage(img: string, index: number) {
    this.onImageClick(index);
    if(this.loginImages.some(img => img.selected)) {
      this.form.get('image').setValue(img);
    } else {
      this.form.get('image').setValue(null);
    }
  }

  send() {
    console.log(this.name)
    if (this.authService.authenticate(this.name, this.image)) {
      this.router.navigate(['inicio']);
    }
  }

  get image() {
    return this.form.get('image').value;
  }

  get name() {
    return this.form.get('name').value;
  }
}
